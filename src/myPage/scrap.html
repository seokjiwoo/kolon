<!DOCTYPE html>
<html lang='ko-kr'>
<head>
	<!-- @@include ../_template/header.html {"title":"COMMON 마이커먼"} -->
</head>
<body data-page-id="myPage-scrap" class="scrap">
	<div class="wrapper my">
	<!-- @@include ../_template/menu.html -->
	<div class="container bgTop">
		<!-- @@include ../_template/my_depth01.html {"myMenu03":"on"} -->
		<!-- @@include ../_template/my_depth02_02.html {"myMenu01":"on"} -->
		<section class="wrap" id="scrapAll">
			<h2 class="hide">모든 스크랩</h2>
			<p style="color:#75be50;">
				┌임시 링크(삭제예정) : <a href="../_popup/popScrapBookAdd.html" class="btnPop btnPop540" data-user-class="popEdge">[스크랩 북에 추가]</a>
				<a href="../_popup/popScrapNew.html" class="btnPop btnPop540" data-user-class="popEdge">[새폴더 만들기]</a>
				<a href="../_popup/popScrapModi.html" class="btnPop btnPop540" data-user-class="popEdge">[폴더 수정하기]</a>
				<a href="../_popup/popScrapDel.html" class="btnPop btnPop540" data-user-class="popEdge">[폴더 삭제]</a>
				<a href="../_popup/popScrapCardDel.html" class="btnPop btnPop540" data-user-class="popEdge">[카드 수정하기]</a>
			</p>
			<!-- [D] 마크업 원본 -->
			<!-- <ul class="cardWrap" id="cardWrap">
				<li class="cardType04 cardSize03"> 상품 스크랩
					<div class="cardLine"><p>handmade</p></div>
					<div class="hexagon" style="background-image: url('/images/temp24.jpg')">배경이미지
						<div class="hexTop"><span></span></div>
						<div class="hexBottom"><span></span></div>
					</div>
					<div class="cardCon">
						<a href="#">
							card 내용
							<h2 class="cardTit">샌드위치모던<b>페이퍼 시계</b></h2>
							<p class="cardPrice">37,000 <span class="priceBottom">won</span></p>
							// card 내용
							card hover 내용
							<div class="cardHover">
								<div class="cardCon">
									card hover 내용
									<div class="cardDetail">
										<div class="cardDetailWrap">
											<span class="like">4.8</span><span class="comt">120</span>
											<div class="cardAuthorPic"><img src="/images/temp01.jpg" alt=""></div>
											<p class="cardAuthorInfo hoverCon"><b>Kittybunnypony</b><br>패브릭 전문 브랜드</p>
										</div>
									</div>
								</div>
							</div>
							// card hover 내용
						</a>
						<a href="" class="removeScrap">삭제</a>
					</div>
				</li>
				<li class="cardSize02"> 이미지 스크랩
					<div class="hexagon" style="background-image: url('/images/temp11.jpg')">배경이미지
						<div class="hexTop"><span></span></div>
						<div class="hexBottom"><span></span></div>
					</div>
					<div class="cardCon">
						<a href="#">
						</a>
						<a href="" class="removeScrap">삭제</a>
					</div>
				</li>
			</ul> -->
			<!--// [D] 마크업 원본 -->
			<ul class="cardWrap" id="cardWrap">
			</ul>
		</section>
		<!-- @@include ../_template/footer.html -->
		</div>
	</div>


<script id="scrap-all-templates" type="text/x-handlebars-template">
	{{!-- scrap-all-templates --}}
	{{#folders}}
	<!-- 상품 스크랩 -->
	<li class="cardType04 cardSize03"
		data-scrapfolder-info='{
		"folderName" : "{{folderName}}",
		"folderNumber" : {{folderNumber}}
	}'>
		<div class="cardLine"><p>handmade</p></div>
		<div class="hexagon" style="background-image: url('/images/temp24.jpg')"><!-- 배경이미지 -->
			<div class="hexTop"><span></span></div>
			<div class="hexBottom"><span></span></div>
		</div>
		<div class="cardCon">
			<a href="/myPage/scrapImage.html?folderName={{folderName}}&amp;folderNumber={{folderNumber}}">
				<!-- card 내용 -->
				<h2 class="cardTit">샌드위치모던<b>페이퍼 시계</b></h2>
				<p class="cardPrice">37,000 <span class="priceBottom">won</span></p>
				<!--// card 내용 -->
				<!-- card hover 내용 -->
				<div class="cardHover">
					<div class="cardCon">
						card hover 내용
						<div class="cardDetail">
							<div class="cardDetailWrap">
								<span class="like">4.8</span><span class="comt">120</span>
								<div class="cardAuthorPic"><img src="/images/temp01.jpg" alt=""></div>
								<p class="cardAuthorInfo hoverCon"><b>Kittybunnypony</b><br>패브릭 전문 브랜드</p>
							</div>
						</div>
					</div>
				</div>
				<!--// card hover 내용 -->
			</a>
			<a href="../_popup/popScrapDel.html" class="btnPop btnPop540 removeScrap" data-user-class="removeScrap popEdge">삭제</a>
		</div>
	</li>
	<!--// 상품 스크랩 -->
	<!-- 이미지 스크랩 -->
	<li class="cardSize02"
		data-scrapfolder-info='{
		"folderName" : "{{folderName}}",
		"folderNumber" : {{folderNumber}}
	}'>
		<div class="hexagon" style="background-image: url('/images/temp11.jpg')">배경이미지
			<div class="hexTop"><span></span></div>
			<div class="hexBottom"><span></span></div>
		</div>
		<div class="cardCon">
			<a href="#">
			</a>
			<a href="" class="removeScrap">삭제</a>
		</div>
	</li>
	<!--// 이미지 스크랩 -->
	{{/folders}} 
	{{!--// scrap-all-templates --}}
</script>

<script id="scrap-images-templates" type="text/x-handlebars-template">
	{{!-- scrap-images-templates --}}
	<li data-scrapfolder-info='{
		"folderName" : "{{folderName}}",
		"folderNumber" : {{folderNumber}}
	}'>
		<span class="packEdge"></span>
		<div class="packTit">
			<a href="../_popup/popScrapModi.html?folderName={{folderName}}&amp;folderNumber={{folderNumber}}" class="btnPop btnPop540 editFolder" data-user-class="scrapFolderEdit popEdge"></a>
			<h3>{{folderName}}<span class="count">{{scrapCount}}</span></h3>
		</div>
		<a href="/myPage/scrapImage.html?folderName={{folderName}}&amp;folderNumber={{folderNumber}}" class="packCon">
			{{#scrapImages}}
				{{#vxIF @index "<" 2}}
				<span><img src="{{imageUrl}}" alt="{{imageTitle}}">{{@index}}</span>
				{{/vxIF}}
			{{/scrapImages}}
		</a>
	</li>
	{{/folders}} 
	{{!--// scrap-images-templates --}}
</script>


<script>
	;(function(win, $) {
		'use strict';

		if ('undefined' === typeof win.vinylX) {
			win.vinylX = {};
		}

		var doc = document,
		NS = win.vinylX;

		var CB_EVENTS = {
			COMPLETE : 'cbox_complete',
			CLEANUP : 'cbox_cleanup',
			CLOSED : 'cbox_closed'
		};

		NS.demoScrapFolders = (function() {
			var defParams = {
				templates : {
					wrap : '#cardWrap',
					source : '#scrap-all-templates'
				},
				colorbox : '#colorbox',
				editFolder : {
					wrap : 'scrapFolderEdit',
					inp : '.js-scrapFolderEdit-inp',
					delete : '.js-scrapFolderEdit-delete',
					submit : '.js-scrapFolderEdit-submit'
				},
				newFolder : {
					wrap : 'scrapFolderNew',
					inp : '.js-scrapFolderNew-inp',
					submit : '.js-scrapFolderNew-submit'
				},
				cssClass : {
				},
				dataAttr : {
					popBtn : '[data-user-class]',
					scrapFolderInfo : '[data-scrapfolder-info]'
				},
				dummyData : {}
			};
			return {
				init : function(container, args) {
					if (!(this.container = container).size()) return;

					this.opts = $.extend({}, defParams, args);

					// win.console.log($(win).scrollTop());

					this.setElements();
					this.dummyData();
					this.setBindEvents();
				},
				dummyData : function() {
					var source = $(this.opts.templates.source).html(),
					template = win.Handlebars.compile(source),
					html = template(this.opts.dummyData);

					// this.templatesWrap.append(html);
					this.templatesWrap.isotope('destroy');
					this.templatesWrap.append(html)
										.isotope({
											itemSelector: '#cardWrap > li',
											masonry: {
												columnWidth: 100,
												gutter: 1
											}
										});

					$('body').trigger('btnPop_refresh');
				},
				setElements : function() {
					this.colorbox = this.container.find(this.opts.colorbox);
					this.templatesWrap = this.container.find(this.opts.templates.wrap);
					this.selPopBtnInfo = {};
				},
				setBindEvents : function() {
					this.templatesWrap.on('click', this.opts.dataAttr.popBtn, $.proxy(this.onWrapPopBtnClick, this));

					$(doc).on(CB_EVENTS.COMPLETE, $.proxy(this.onCboxEventListener, this))
							.on(CB_EVENTS.CLEANUP, $.proxy(this.onCboxEventListener, this))
							.on(CB_EVENTS.CLOSED, $.proxy(this.onCboxEventListener, this));
				},
				onWrapPopBtnClick : function(e) {
					var target = $(e.target),
					info = target.closest(this.opts.dataAttr.scrapFolderInfo).data('scrapfolder-info');

					this.selPopBtnInfo = {
						target : target,
						info : info
					};
				},
				onCboxEventListener : function(e) {
					switch(e.type) {
						case CB_EVENTS.COMPLETE:
							if (this.colorbox.hasClass(this.opts.editFolder.wrap)) {
								this.setScrapFolderEdit();
							}

							if (this.colorbox.hasClass(this.opts.newFolder.wrap)) {
								this.setScrapFolderNew();
							}
							break;
						case CB_EVENTS.CLEANUP:
							if (this.colorbox.hasClass(this.opts.editFolder.wrap)) {
								this.destroyScrapFolderEdit();
							}
							break;
						case CB_EVENTS.CLOSED:
							break;
					}
				},
				setScrapFolderEdit : function() {
					this.colorbox.find(this.opts.editFolder.inp).val(this.selPopBtnInfo.info.folderName);
					this.colorbox.find(this.opts.editFolder.delete).on('click', $.proxy(function(e) {
						e.preventDefault();

						var target = $(e.target);
						win.console.log('폴더 수정하기 - 폴더삭제', target, this.colorbox.find(this.opts.editFolder.inp).val(), this.selPopBtnInfo, this.selPopBtnInfo.info.folderNumber);
						// DELETE - /apis/scraps/folders/{folderNumber}
					}, this));
					this.colorbox.find(this.opts.editFolder.submit).on('click', $.proxy(function(e) {
						e.preventDefault();

						var target = $(e.target),
						inp = this.colorbox.find(this.opts.editFolder.inp);

						if (!inp.val() || inp.val() === ' ') {
							win.alert('폴더명을 입력하세요.');
							inp.focus();
							return;
						}
						if (inp.val() === this.selPopBtnInfo.info.folderName) {
							win.console.log('폴더명 동일 - 저장', target, this.colorbox.find(this.opts.editFolder.inp).val(), this.selPopBtnInfo, this.selPopBtnInfo.info.folderNumber);
							return;
						}

						win.console.log('폴더 수정하기 - 저장', target, this.colorbox.find(this.opts.editFolder.inp).val(), this.selPopBtnInfo, this.selPopBtnInfo.info.folderNumber);
						// PUT - /apis/scraps/folders/{folderNumber}
						// data - folderName
					}, this));
				},
				destroyScrapFolderEdit : function() {
					if (this.colorbox.hasClass(this.opts.editFolder.wrap)) {
						this.colorbox.find(this.opts.editFolder.delete).off('click');
						this.colorbox.find(this.opts.editFolder.submit).off('click');
					}
				},
				setScrapFolderNew : function() {
					this.colorbox.find(this.opts.newFolder.submit).on('click', $.proxy(function(e) {
						e.preventDefault();

						var target = $(e.target),
						inp = this.colorbox.find(this.opts.newFolder.inp);

						if (!inp.val() || inp.val() === ' ') {
							win.alert('폴더명을 입력하세요.');
							inp.focus();
							return;
						}

						win.console.log('새폴더 만들기 - 저장', target, this.colorbox.find(this.opts.newFolder.inp).val());
						// POST - /apis/scraps/folders
						// data - folderName
					}, this));
				}
			};
		})();

		$(function() {
			return;
			NS.demoScrapFolders.init($('body'), {
				dummyData : {"folders":[{"folderName":"폴더1","folderNumber":0,"recentImageTitle":"string","recentImageUrl":"string","scrapCount":2,"scrapImages":[{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"}]},{"folderName":"폴더2","folderNumber":0,"recentImageTitle":"string","recentImageUrl":"string","scrapCount":5,"scrapImages":[{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"}]},{"folderName":"폴더3","folderNumber":0,"recentImageTitle":"string","recentImageUrl":"string","scrapCount":10,"scrapImages":[{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"},{"imageTitle":"string","imageUrl":"../images/temp11.jpg"}]},{"folderName":"폴더3","folderNumber":0,"recentImageTitle":"string","recentImageUrl":"string","scrapCount":1,"scrapImages":[{"imageTitle":"string","imageUrl":"../images/temp11.jpg"}]}],"scraps":[{"category":"string","imageUrl":"string","magazine":{"createDate":"string","subTitle":"string","title":"string"},"product":{"price":0,"productDesc":"string","productName":"string"},"scrapCount":0,"scrapNumber":0,"seller":{"companyName":"string","sellerImageUrl":"string","sellerName":"string"},"tags":["string"]}]}
			});
		});
	})(window, window.jQuery);
</script>

</body>
</html>
